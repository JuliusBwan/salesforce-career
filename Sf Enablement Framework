

3. Authentication, Access & Permissions
Description

Overview of how users authenticate and are authorised within Salesforce.

Includes

SSO model and identity provider integration (high-level)

User provisioning approach

Permission set strategy

Access request and approval flow

Why this exists

Supports onboarding, troubleshooting, and audit readiness while maintaining security clarity.

4. Integration Landscape
Description

Overview of Salesforce integrations with external systems.

Includes

List of integrations

Purpose of each integration

Direction of data flow (inbound/outbound)

Owning system and support contact

High-level data exchanged

Why this exists

Creates transparency, supports troubleshooting, and prepares internal teams for ownership post-MSP.

5. Development Guidelines
Description

A living set of development guidelines to promote consistency and maintainability.

Includes

Naming conventions

Flow vs Apex guidance

Error handling expectations

Logging and debugging patterns

Code readability and structure principles

Design review expectations

Why this exists

Supports scalable development practices as the internal team grows.

8. Security & Integration Hygiene
Description

Documentation supporting secure and compliant integration practices.

Includes

API key and secret storage locations

Rotation and expiry expectations

Ownership and approval model

Interaction with InfoSec processes

Known risks or dependencies

Why this exists

Improves security posture and audit readiness without duplicating InfoSec ownership.

9. Great â€” Iâ€™ll create **clear, beginnerâ€‘friendly architecture diagrams** (in text form) and **stepâ€‘byâ€‘step instructions** so you can start building secure integrations confidently.  
Everything below is based on the latest Salesforce integration & security practices (2025â€“2026), including External Credentials + Named Credentials as the preferred method  and how bearer tokens or API keys are safely stored and injected in headers. [\[help.salesforce.com\]](https://help.salesforce.com/s/articleView?id=xcloud.named_credentials_about.htm&language=en_US&type=5), [\[apexhours.com\]](https://www.apexhours.com/named-credentials-in-salesforce/) [\[sfcrunch.com\]](https://sfcrunch.com/integrating-salesforce-external-services-with-bearer-token-authentication-via-named-credentials/)

***

# ğŸ—ï¸ **ARCHITECTURE DIAGRAMS FOR SAFE SALESFORCE INTEGRATIONS**

Below are text-based diagrams that visually explain how each integration method works.

***

# **1. External Credentials + Named Credentials (Recommended for 95% of Integrations)**

### ğŸ”’ Safest, modern, Salesforce-endorsed approach

Salesforce introduced enhanced Named Credentials that are â€œextensible, customizable, and more secure,â€ strongly recommending them over legacy methods. [\[help.salesforce.com\]](https://help.salesforce.com/s/articleView?id=xcloud.named_credentials_about.htm&language=en_US&type=5)

### ğŸ”§ Architecture Diagram (Text Form)

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     External Credential      â”‚          â”‚      External System         â”‚
    â”‚  (Stores API Key / Token)    â”‚â”€â”€secureâ”€â”€â”‚ (e.g., AWS, PayPal, REST API)â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ (linked)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚       Named Credential       â”‚
    â”‚ - Holds Endpoint URL         â”‚
    â”‚ - Adds Auth Headers          â”‚
    â”‚ - No credentials in Apex     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ reference
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚            APEX              â”‚
    â”‚ HttpRequest req =            â”‚
    â”‚   new HttpRequest();         â”‚
    â”‚ req.setEndpoint('callout:X') â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

### ğŸ§‘â€ğŸ« Beginner Explanation

*   **External Credential** = locked vault storing secrets
*   **Named Credential** = how Salesforce calls the external system
*   **Apex code never sees or touches the secret**
*   **Salesforce injects keys/tokens for you**

This is the most secure way because tokens never appear in code or logs, aligning with best practices and preventing secret leakage. [\[apexhours.com\]](https://www.apexhours.com/named-credentials-in-salesforce/)

***

# **2. OAuth 2.0 with PKCE (For User-Based Integrations)**

### ğŸ” Salesforce recommends PKCE for secure token exchange and replacing unsafe Device Flow by 2025â€“26 [\[tekunda.com\]](https://tekunda.com/blog/Salesforce-Authentication-Your-Complete-Migration-Guide).

### ğŸ”§ Architecture Diagram

    User â†’ Salesforce â†’ Authorization Server â†’ Token â†’ Named Credential â†’ External API

### When to Use

*   Integrations requiring users to log in (Google, Microsoft, custom identity providers)

### Why Secure

*   PKCE prevents â€œauthorization code interceptionâ€ attacks
*   No credentials or secrets stored in Apex

***

# **3. OAuth 2.0 JWT Bearer Flow (Server-to-Server)**

### ğŸ” Best for backend-to-backend automated flows.

### ğŸ”§ Architecture Diagram

    Private Key â†’ Salesforce â†’ JWT â†’ Auth Server â†’ Access Token â†’ Named Credential â†’ API Call

### When to Use

*   Microservices
*   Back-end systems (Azure Functions, AWS Lambda, Mulesoft)

***

# **4. API Key integrations (When API-only services are used)**

### Salesforce supports storing API keys using External Credentials and adding them as headers using Named Credentials [\[sfcrunch.com\]](https://sfcrunch.com/integrating-salesforce-external-services-with-bearer-token-authentication-via-named-credentials/).

### ğŸ”§ Architecture Diagram

    External Credential (API Key)
            â”‚
       Named Credential (adds header: Authorization: Bearer â€¦)
            â”‚
           Apex â†’ External API

### When to Use

*   Third-party APIs that *only* support keys (no OAuth)

### Why Safe

*   Key is encrypted
*   Never appears in Apex
*   Delivered via secure HTTP header (not URL) after Salesforce blocked secret substitution into URLs for safety reasons [\[help.salesforce.com\]](https://help.salesforce.com/s/articleView?id=004695556&language=en_US&type=1)

***

# **5. Fallback: Custom Metadata (API Keys)**

### Only when URL-based API keys are forced by the provider

Salesforce explains that embedding secrets in URLs is blocked in Named Credentials for security. [\[help.salesforce.com\]](https://help.salesforce.com/s/articleView?id=004695556&language=en_US&type=1)

### ğŸ”§ Architecture Diagram

    Custom Metadata (protected) â†’ Apex retrieves key â†’ Callout

### Not recommended except for very lowâ€‘risk APIs.

***

# ğŸ“ **STEP-BY-STEP IMPLEMENTATION GUIDE (Beginner-Friendly)**

Letâ€™s build a **real integration example**: calling an external service using a bearer token or API key via External + Named Credentials.

***

# **STEP 1 â€” Create an External Credential**

External Credentials store authentication details securely and support tokens, passwords, or keys. [\[blogs.perficient.com\]](https://blogs.perficient.com/2025/01/06/understanding-external-credentials-and-named-credentials-in-salesforce/)

### Steps

1.  Go to **Setup â†’ Named Credentials â†’ External Credentials â†’ New**
2.  Select **Authentication Protocol: Custom**
3.  Add a **Principal**
    *   Name: `MyServicePrincipal`
    *   Store your API key/token here
4.  Add **Headers** (if needed)  
    Example header (supported per Salesforce docs):
    *   Header Name: `Authorization`
    *   Value: `Bearer {!$Credential.MyService.api_key}` [\[sfcrunch.com\]](https://sfcrunch.com/integrating-salesforce-external-services-with-bearer-token-authentication-via-named-credentials/)

Now Salesforce will inject this header securely.

***

# **STEP 2 â€” Create the Named Credential**

Named Credentials bind the endpoint to the authentication method and hide secrets from Apex.  
This approach is â€œmore secure and recommended over legacy modelsâ€. [\[help.salesforce.com\]](https://help.salesforce.com/s/articleView?id=xcloud.named_credentials_about.htm&language=en_US&type=5), [\[greytrix.com\]](https://www.greytrix.com/blogs/salesforce/2025/07/02/secure-api-integrations-in-salesforce-using-named-credentials/)

### Steps

1.  **Setup â†’ Named Credentials â†’ New**
2.  Name: `MyServiceNC`
3.  URL: e.g., `https://api.example.com`
4.  Authentication: **Use External Credential**
5.  Choose the External Credential you created

Doneâ€”Salesforce will now apply headers automatically.

***

# **STEP 3 â€” Call the Endpoint in Apex (Beginner Friendly)**

```apex
HttpRequest req = new HttpRequest();
req.setEndpoint('callout:MyServiceNC/my/path');
req.setMethod('GET');

Http http = new Http();
HttpResponse res = http.send(req);

System.debug(res.getBody());
```

No tokens, no API keys, no passwords in your code â€” fully secure.

***

# **STEP 4 â€” Assign Access to Users**

Salesforce requires users to have access to External Credential â€œprincipalsâ€ via Permission Set so they can make authenticated callouts. [\[sfcrunch.com\]](https://sfcrunch.com/integrating-salesforce-external-services-with-bearer-token-authentication-via-named-credentials/)

***

# ğŸ¯ **Final Summary: Your Safe Integration Strategy**

| Method                                | Best For                 | Security | Notes                                                                                                                                                                          |
| ------------------------------------- | ------------------------ | -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **External + Named Credentials**      | Almost all integrations  | â­â­â­â­â­    | Recommended by Salesforce (2025â€“26)                                                                                                                                            |
| **OAuth 2.0 PKCE**                    | User-facing integrations | â­â­â­â­â­    | Required as Device Flow is deprecated by 2025 [\[tekunda.com\]](https://tekunda.com/blog/Salesforce-Authentication-Your-Complete-Migration-Guide) |
| **OAuth 2.0 JWT**                     | Server-to-server         | â­â­â­â­â­    | Most secure backend method                                                                                                                                                     |
| **API Keys via External Credentials** | Key-based services       | â­â­â­â­     | Keys stay encrypted & injected in headers                                                                                                                                      |
| **Custom Metadata**                   | Only legacy needs        | â­â­       | Avoid unless necessary                                                                                                                                                         |
| **Hardcoding Secrets**                | Never                    | â­        | Forbidden; unsafe                                                                                                                                                              |

***

# ğŸš€ Next Step

Would you like me to create:

1.  **A stepâ€‘byâ€‘step guide for a REAL integration** (e.g., Google Maps, Stripe, AWS, Azure, HubSpot, PayPal)?
2.  **A complete Apex + Named Credential template package** you can reuse in projects?
3.  **A visual architecture diagram (PNG)** for documentation?

Just tell me which one you'd like!

